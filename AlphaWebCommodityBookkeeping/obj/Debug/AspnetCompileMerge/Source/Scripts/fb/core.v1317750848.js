var Fresh=window.Fresh={};Fresh.Util={getTemplate:function(d,b){var a=$(d).html();try{return jsontemplate.Template(a,$.extend({undefined_str:""},b))}catch(c){alert("Error loading template")}},disableFormSubmit:function(a){return a.which!=13}};Fresh.Math={clamp:function(c,b,a){return Math.min(Math.max(c,b),a)}};Fresh.Preferences=function(){var a={};return{get:function(b){if(a[b]!==undefined){return a[b]}return undefined},set:function(c,e){var d={};if(typeof c==="string"&&e!==undefined){d[c]=e}else{d=c}for(var b in d){if(!d.hasOwnProperty(b)){continue}if(a[b]!==undefined&&a.testing!==undefined&&a.testing===false){throw"Cannot modify preferences in non-test mode."}a[b]=d[b]}return true},reset:function(){if(a.reset===true&&a.testing===false){a={};return true}return false}}}();function pngTrans(f){var h=navigator.appVersion.split("MSIE");var c=parseFloat(h[1]);if((c>=5.5)&&(c<7)&&(document.body.filters)){var b=(f.id)?"id='"+f.id+"' ":"";var e=(f.className)?"class='"+f.className+"' ":"";var g=(f.title)?"title='"+f.title+"' ":"title='"+f.alt+"' ";var d="display:inline-block;"+f.style.cssText;var a="<span "+b+e+g+' style="width:'+f.width+"px; height:"+f.height+"px;"+d+"; filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+f.src+"', sizingMethod='scale');\"></span>";f.outerHTML=a}}function setPreferenceTrue(a,b){$.post("/ajax/preference/userEnable",{preference:a},b)}function togglePreference(a,b){$.post("/ajax/preference/userToggle",{preference:a},b)}function setAccountPreferenceTrue(a,b){$.post("/ajax/preference/accountEnable",{preference:a},b)}function toggleAccountPreference(a,b){$.post("/ajax/preference/accountToggle",{preference:a},b)}function toggleHelpBoxesPreference(a){togglePreference(a,function(){$("#help_box").animate({height:"hide",opacity:"hide",marginBottom:"-25px"},"slow")})}function toggleLegendsPreference(a){togglePreference(a,function(){if($("#legend_box").is(":hidden")){$("#hide_legend").fadeOut("fast",function(){$("#legend_box").slideDown()})}else{$("#legend_box").fadeOut("normal",function(){$("#hide_legend").fadeIn("fast")})}})}function open_progress_window(a){var b=window.open("progress.php?caption="+a,"progress_window","width=250, height=110, top="+((screen.height-100)/2)+",left="+((screen.width-250)/2)+", screenX="+((screen.height-100)/2)+",screenY="+((screen.width-250)/2)+", menubar=no, statusbar=no, toolbar=no");$(window).unload(function(){if(b!=null){b.close()}})}function newWin(e,d,a){var c=(screen.width-d)/2,b=(screen.height-a)/2;window.open(e,"Window","width="+d+", height="+a+", top="+b+", left="+c+", scrollbars = 1, resizable = 1")}function NotOneChecked(b){for(var a=0;a<document.form.elements.length;a++){if(document.form.elements[a].name){if(document.form.elements[a].name.indexOf(b)>=0){if(document.form.elements[a].checked){return false}}}}alert("No items were selected.");return true}function Check_Uncheck(b,a){if(!(b instanceof jQuery)){b=$(b)}if(!(a instanceof jQuery)){a=$('input[name="'+a+'"]')}if(b.is(":checked")){a.attr("checked",true)}else{a.removeAttr("checked")}return true}function resetAPIToken(a){$("p#api_token").html("&hellip;");$("input#api_token").attr("value","\u2026");var b={};if(a){b.userid=a}$.ajax({type:"POST",url:"/ajax/client/resetAPIToken",data:b,success:function(c){$("p#api_token").text(c.api_token);$("input#api_token").val(c.api_token)},dataType:"json",error:function(c){alert("Sorry an error occurred trying to reset your API token.")}});return false}function zero_trim(a){if(a.indexOf(".")!==-1){return a.replace(/0*$/,"").replace(/\.+$/,"")}return a}Fresh.Date=function(){var k=[],j,m=/^(\d+)\/(\d+)\/(\d+)$/,g=/^(\d+)\-(\d+)\-(\d+)$/,c=new Date(),a=c.getFullYear(),e=Math.round(a/100),l=e-1;var h=function(n){if(n>2000){n=n.substring(2)}return(n>50)?l+n:e+n};var d=function(n){return(n<100)?e+n:n};k.push({parser:m,stringFormat:"mm/dd/yy",map:function(n){n[3]=h(n[3]);return{month:n[1],day:n[2],year:n[3]}},toDate:function(n){n[3]=h(n[3]);return new Date(n[3],n[1]-1,n[2])},toString:function(n){return(Fresh.Date.padZero((n.getMonth()+1),2)+"/"+Fresh.Date.padZero(n.getDate(),2)+"/"+String(n.getFullYear()).substr(2,4))}});k.push({parser:m,stringFormat:"mm/dd/yyyy",map:function(n){n[3]=d(n[3]);return{month:n[1],day:n[2],year:n[3]}},toDate:function(n){return new Date(n[3],n[1]-1,n[2])},toString:function(n){return(Fresh.Date.padZero(n.getMonth()+1,2)+"/"+Fresh.Date.padZero(n.getDate(),2)+"/"+n.getFullYear())}});k.push({parser:m,stringFormat:"dd/mm/yy",map:function(n){n[3]=h(n[3]);return{month:n[2],day:n[1],year:n[3]}},toDate:function(n){n[3]=h(n[3]);return new Date(n[3],n[2]-1,n[1])},toString:function(n){return(Fresh.Date.padZero(n.getDate(),2)+"/"+Fresh.Date.padZero(n.getMonth()+1,2)+"/"+String(n.getFullYear()).substr(2,4))}});k.push({parser:m,stringFormat:"dd/mm/yyyy",map:function(n){n[3]=d(n[3]);return{month:n[2],day:n[1],year:n[3]}},toDate:function(n){return new Date(n[3],n[2]-1,n[1])},toString:function(n){return(Fresh.Date.padZero(n.getDate(),2)+"/"+Fresh.Date.padZero(n.getMonth()+1,2)+"/"+n.getFullYear())}});k.push({parser:g,stringFormat:"yy-mm-dd",map:function(n){n[1]=h(n[1]);return{month:n[2],day:n[3],year:n[1]}},toDate:function(n){n[1]=h(n[1]);return new Date(n[1],n[2]-1,n[3])},toString:function(n){return(String(n.getFullYear()).substr(2,4)+"-"+Fresh.Date.padZero(n.getMonth()+1,2)+"-"+Fresh.Date.padZero(n.getDate(),2))}});var f={parser:g,stringFormat:"yyyy-mm-dd",map:function(n){n[1]=d(n[1]);return{month:n[2],day:n[3],year:n[1]}},toDate:function(n){return new Date(n[1],n[2]-1,n[3])},toString:function(n){return(n.getFullYear()+"-"+Fresh.Date.padZero((n.getMonth()+1),2)+"-"+Fresh.Date.padZero(n.getDate(),2))}};var b=function(n){if(k[n]){j=k[n]}else{j=f}};return{toDate:function(p,n){b(n);var o=j.parser.exec(p);if(!o||!o.length){return false}return j.toDate(o)},toString:function(o,n){b(n);return j.toString(o)},toHash:function(p,n){b(n);var o=j.parser.exec(p);if(!o||!o.length){return false}return j.map(o)},isoDate:function(p,n){var o=Fresh.Date.toDate(p,n);if(!o){return false}return(o.getFullYear()+"-"+Fresh.Date.padZero(o.getMonth()+1,2)+"-"+Fresh.Date.padZero(o.getDate(),2))},valid:function(q){var s=Fresh.Preferences.get("date_format");b(s);var p=j.parser.exec(q);if(!p||!p.length){return false}var o=j.map(p);if(o.year.length>4){return false}var t=new Date(o.year,o.month-1,o.day);var r=o.year+"-"+o.month+"-"+o.day;var n=(t.getFullYear()+"-"+Fresh.Date.padZero(t.getMonth()+1,2)+"-"+Fresh.Date.padZero(t.getDate(),2));if(r!==n){return false}return true},systemFormat:function(){var n=Fresh.Preferences.get("date_format");b(n);return j.stringFormat},alertOnInvalidDate:function(n){var o=document.getElementById(n).value;if(!Fresh.Date.valid(o)){alert("Please verify that you have entered a valid date format ("+Fresh.Date.systemFormat()+"). We recommend using the date picker provided.");return false}return true},padZero:function(o,q){var r="",n=q-String(o).length,p;for(p=0;p<n;p++){r+="0"}return r+o},fixInvalidDate:function(o){var n=new Date(o.substring(0,4),o.substring(5,7)-1,o.substring(8,10));if(n.getDate()!=o.substring(8,10)){n.setDate("0");return o.substring(0,8)+n.getDate()}return o}}}();(function(){var a={padZero:Fresh.Date.padZero,str2dt:Fresh.Date.toDate,dt2dtstr:Fresh.Date.toString,str2dtstr:Fresh.Date.isoDate,validDateString:Fresh.Date.valid,alertOnInvalidDate:Fresh.Date.alertOnInvalidDate,systemDateFormat:Fresh.Date.systemFormat};for(var b in a){window[b]=a[b]}})();function generateDateRangeValidator(b,a,c){if(c===undefined){c="Please ensure that the selected start date is before the selected end date."}return function(f){try{$(b+", "+a).removeClass("errorInput").each(function(){if(!Fresh.Date.valid($(this).val())){$(this).addClass("errorInput").focus();throw"Invalid date selected"}});var h=Fresh.Date.toDate($(b).val(),Fresh.Preferences.get("date_format"));var d=Fresh.Date.toDate($(a).val(),Fresh.Preferences.get("date_format"));if(h>d){alert(c);throw"Invalid date range chosen"}}catch(g){f.stopPropagation();f.preventDefault()}}}Fresh.Array={batchDelay:150,delayedBatchProcess:function(c,e,b){var d=0,a=c.length;setTimeout(function(){var f=+new Date();do{e(c[d]);d++}while(a>d&&(+new Date()-f<Fresh.Array.batchDelay));if(a>d){setTimeout(arguments.callee,15)}else{if(typeof b=="function"){b(c)}}},0)},sortComboboxItems:function(d,c){var f=d.text.toLowerCase(),e=c.text.toLowerCase();if(f===e){return 0}return f<e?-1:1}};function Pad(a){if(a<10){return"0"+a}else{return""+a}}function UnPad(a){if(a.substring(0,1)=="0"){a=a.substring(1,2)}return parseInt(a,10)}function roundNumber(b,a){return Number(b).toFixed(a)}function timeToDecimalFormat(e){var c,a,b,d;c=e.split(":");a=c[0]==""?0:parseFloat(c[0]);b=c[1]!==undefined?parseFloat(c[1]):0;return a+b/60}function roundFloat2(a){if(isNaN(a)){a=0}return String(Number(a).toFixed(2))}function isPrintableKey(b){if(b.altKey||b.ctrlKey||b.metaKey){return false}var a=b.which;if(a<32||a==144){return false}return true}function timeonly(p,f){var a=jQuery.event.fix(f||window.event),m=a.which,d=String.fromCharCode(m);if(m===undefined){return true}var h=p.value;var c=h.indexOf(".");if(c==-1){c=h.indexOf(":")}var j=(d=="."||d==":");var l=TextSelection.selectedValue(p);var k=TextSelection.startPos(p);var n=TextSelection.endPos(p);var b=k-n;var o=j&&l&&l.indexOf(d)>-1;if(!isPrintableKey(a)||o){return true}if(c>=0){var g=(h.length-c);if(k>c&&b===0&&g>2){return false}if(b==g){return true}if(j){return false}}else{if(j&&(k<=h.length-3)){return false}}if("0123456789.:".indexOf(d)>-1){return true}return false}function numbersonly(j,f){var d=jQuery.event.fix(f||window.event),a=d.which,h=String.fromCharCode(a);if(a===undefined){return true}if(!isPrintableKey(d)){return true}else{if("0123456789.".indexOf(h)>-1){var c=TextSelection.selectedValue(j);var g=h+j.value;if(c){g=g.replace(c,"")}var b=g.split(".").length;if(b>2){return(false)}return true}else{return false}}}function clampdec(b,a){return Number(b).toPrecision(a-1)}function alphanumericonly(f,c){var b=jQuery.event.fix(c||window.event),a=b.which,d=String.fromCharCode(a);if(a===undefined){return true}if(!isPrintableKey(b)){return true}else{if("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(d)>-1){return true}}return false}function invoicenumberonly(f,c){var b=jQuery.event.fix(c||window.event),a=b.which,d=String.fromCharCode(a);if(a===undefined){return true}if(!isPrintableKey(b)){return true}else{if(/[A-Za-z0-9 #\,.\/:_\-]/.test(d)){return true}}return false}var TextSelection={current:function(){if(document.getSelection){return document.getSelection().toString()}if(document.selection){return document.selection.createRange().text}},selectedValue:function(a){if(a.selectionStart!==undefined){return a.value.substring(a.selectionStart,a.selectionEnd)}if(document.selection){return document.selection.createRange().text}},startPos:function(b){if(b.selectionStart!==undefined){return b.selectionStart}if(document.selection){var a=document.selection.createRange();return b.value.indexOf(a.text)}},endPos:function(b){if(b.selectionEnd!==undefined){return b.selectionEnd}if(document.selection){var a=document.selection.createRange();return b.value.indexOf(a.text)+a.text.length}}};function numbersonlynegative(k,f){var b=jQuery.event.fix(f||window.event),j=b.which,c=String.fromCharCode(j);if(j===undefined){return true}if(!isPrintableKey(b)){return true}else{if("0123456789.-".indexOf(c)>-1){var h=TextSelection.selectedValue(k);var g=c+k.value;if(h){g=g.replace(h,"")}var d=g.split(".").length;var a=g.split("-").length;if(d>2||a>2){return false}return true}else{return false}}}function integersonly(f,c){var b=jQuery.event.fix(c||window.event),a=b.which,d=String.fromCharCode(a);if(a===undefined){return true}if(!isPrintableKey(b)){return true}else{if("0123456789".indexOf(d)>-1){return true}}return false}numbersonly2=integersonly;var FbCalendar={idCounter:0,instances:[],heightOffset:2,formatType:0,borderColor:"#dddddd",weekDayNames:["S","M","T","W","T","F","S"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],SINGLE:1,DOUBLE:2,LEFT:4,RIGHT:8,ABOVE:16,BELOW:32,BOTH:0,PREV_ONLY:1,NEXT_ONLY:2,get:function(a){return $(a).data("calendar")},setFormat:function(a){this.formatType=a},formatDate:function(a){return Fresh.Date.toString(a,FbCalendar.formatType)},datesEqual:function(b,a){return !(b>a)&&!(b<a)},extractDate:function(b){var c=Fresh.Date.toHash(b,this.formatType);if(!c){c=Fresh.Date.toHash(Fresh.Date.toString(new Date,this.formatType),this.formatType)}for(var a in c){c[a]=parseInt(c[a],10)}return c},showCalendarEvent:function(b){var a=b.target;FbCalendar.get(a).show()},hideCalendarEvent:function(b){var a=b.target;FbCalendar.get(a).hide()},refreshCalendarEvent:function(c){for(var a=0;a<FbCalendar.instances.length;a++){var b=FbCalendar.instances[a];b.hide()}},mouseOverEvent:function(a){a.mouseOverCalendar=true},mouseOutEvent:function(a){a.mouseOverCalendar=false},mouseClickEvent:function(a){inputElem=a.input;inputElem.focus()},create:function(b,e){var d="fb-double";if(e&FbCalendar.SINGLE){d="fb-single"}var c={currentMonth:null,currentYear:null,lastSelected:null,lastInputValue:null,visible:false,type:e,dirtyFlag:true,input:b,div:null,container:null,frameshim:null,id:this.idCounter++,dates:[[],[]],calendarElement:false,mouseOverCalendar:false,create:function(){this.calendarElement=true;var h=document.createElement("div");var f='<div class="fb-container" style="display:none">  <div class="fb-calendar '+d+'" style="background-color:'+FbCalendar.borderColor+'">  </div></div>';h.innerHTML=f;var g=document.getElementById("fb_calendar_anchor");if(!g){g=document.createElement("div");g.setAttribute("id","fb_calendar_anchor");document.body.appendChild(g)}g.parentNode.insertBefore(h,g);this.div=$(h).find("div.fb-calendar")[0];this.container=$(h).find("div.fb-container")[0];$(h).find("div:first").click(function(){FbCalendar.mouseClickEvent(c)}).mouseover(function(){FbCalendar.mouseOverEvent(c)}).mouseout(function(){FbCalendar.mouseOutEvent(c)})},buildTable:function(m,n,f,r){var h=new Date(n,m-1,1);var m=h.getMonth()+1;var n=h.getFullYear();var o=h.getDay();var p=new Date(n,m,0).getDate();var q=0;var k=0;var j="";j+='<div class="calPad"><table rel="'+f+'" class="cal_main" cellspacing="1" cellpadding="0" style="background-color: #ddd;" id="cal_main-'+this.id+'">';j+='  <thead><tr><td class="button">';if(r==FbCalendar.BOTH||r==FbCalendar.PREV_ONLY){j+='   <a href="#" class="prev">&#171;</a>'}j+="    </td>";j+='    <td colspan="5" class="title">'+FbCalendar.monthNames[m-1]+" "+n+"</td>";j+='    <td class="button">';if(r==FbCalendar.BOTH||r==FbCalendar.NEXT_ONLY){j+='    <a href="#" class="next">&#187;</a>'}j+="    </td></tr></thead>";j+='  <tbody><tr class="days">';for(i=0;i<7;i++){j+="  <td>"+FbCalendar.weekDayNames[i]+"</td>"}j+="  </tr>";for(row=0;row<6;row++){j+="<tr>";for(col=0;col<7;col++){var l=k>=o;var g=k<p+o;k+=1;if(col>4&&row>4&&(r==FbCalendar.NEXT_ONLY||r==FbCalendar.BOTH)){j+='<td class="button cal_close" colspan="2"><a href="#">Close</a></td>';break}if(l&&g){date=new Date(n,m-1,q+1);if(this.lastSelectedDate&&FbCalendar.datesEqual(date,this.lastSelectedDate)){j+='<td class="selected">'}else{j+="<td>"}j+='<a href="#" class="date" rel="'+q+'">'+(q+1)+"</td>";this.dates[f][q]=date;q+=1}else{j+='<td class="cal_empty">&nbsp;</td>'}}j+="</tr>"}j+="</tbody></table></div>";return j},render:function(){if(!this.calendarElement){this.create()}var h=new Date(this.currentYear,this.currentMonth-1,1).getDay();var g=new Date(this.currentYear,this.currentMonth,0).getDate();var j=this.div;if(e==FbCalendar.DOUBLE){leftTable=this.buildTable(this.currentMonth,this.currentYear,0,FbCalendar.PREV_ONLY);rightTable=this.buildTable(this.currentMonth+1,this.currentYear,1,FbCalendar.NEXT_ONLY);j.innerHTML=leftTable+rightTable}else{table=this.buildTable(this.currentMonth,this.currentYear,0,FbCalendar.BOTH);j.innerHTML=table}j.innerHTML+='<div style="clear:both">';var f=this;$(j).find("a.prev").click(function(k){FbCalendar.get(f.input).prevMonth();k.cancelBubble=true;return false}).end().find("a.next").click(function(k){FbCalendar.get(f.input).nextMonth();k.cancelBubble=true;return false}).end().find("td.cal_close a").click(function(k){FbCalendar.get(f.input).hide(true);k.cancelBubble=true;return false}).end().find("table").each(function(){var k=$(this).attr("rel");$(this).find("a.date").click(function(n){var m=FbCalendar.get(f.input);var l=$(this).attr("rel");m.pickDate(k,l);n.cancelBubble=true;return false})});this.dirtyFlag=false;if($.browser.msie&&$.browser.version==6){this.frameshim=document.createElement("IFRAME");this.frameshim.frameBorder="0";this.frameshim.style.border="0";this.frameshim.style.display="none";this.frameshim.style.position="absolute";this.frameshim.src="javascript:false;";this.frameshim.width=0+"px";document.body.insertBefore(this.frameshim,document.body.firstChild)}},nextMonth:function(){if(this.currentMonth==12){this.changeDate(1,this.currentYear+1,true)}else{this.changeDate(this.currentMonth+1,this.currentYear,true)}},prevMonth:function(){if(this.currentMonth==1){this.changeDate(12,this.currentYear-1,true)}else{this.changeDate(this.currentMonth-1,this.currentYear,true)}},readDate:function(){var h=this.input;var g=h.value;var f=FbCalendar.extractDate(g);if(f.month&&f.year){this.changeDate(f.month,f.year);if(f.day){this.lastInputValue=h.value;this.lastSelectedDate=new Date(f.year,f.month-1,f.day);this.dirtyFlag=true}}},changeDate:function(h,f,g){this.currentMonth=h;this.currentYear=f;this.render();if(g){inputElem=this.input;inputElem.focus()}},attachTo:function(f){elem=document.getElementById(f);elem.onclick=function(g){if(!g){var g=window.event}if(g.target){var h=g.target.id}if(g.srcElement){var h=g.srcElement.id}document.getElementById(FbCalendar.get(h)).focus()}},pickDate:function(h,g){var f=this.input;f.value=Fresh.Date.toString(this.dates[h][g],FbCalendar.formatType);this.lastInputValue=f.value;this.dirtyFlag=true;this.lastSelectedDate=this.dates[h][g];this.hide(true)},hide:function(f){if(f||!this.mouseOverCalendar){if(this.container){$(this.container).hide()}this.visible=false}if(this.frameshim){this.frameshim.style.display="none"}},show:function(){var h=this.input;if(!this.visible&&h.value!=this.lastInputValue){this.readDate()}if(!this.calendarElement){this.create()}if(this.dirtyFlag){this.render()}var m=this.container;m.style.position="absolute";var f=findPos(h);var k=proto_getDimensions(h);var j=util_windowDims();var l=util_scrollDims();var g=proto_getDimensions(m);if((f[0]+g[0]>j[0])&&(f[0]-g[0]+k[0]>0)){m.style.left=(f[0]+k[0]-g[0])+"px"}else{m.style.left=f[0]+"px"}if((f[1]+k[1]+g[1]>j[1]+l[1])&&(f[1]-g[1]>l[1])){m.style.top=(f[1]-proto_getHeight(m)-FbCalendar.heightOffset)+"px"}else{m.style.top=(f[1]+proto_getHeight(h)+ +FbCalendar.heightOffset)+"px"}m.style.display="block";this.visible=true;if(this.frameshim){this.frameshim.width=m.offsetWidth+"px";this.frameshim.style.display="block";this.frameshim.style.top=m.style.top;this.frameshim.style.left=m.style.left;this.frameshim.style.height=m.offsetHeight}},refresh:function(){if(this.visible){this.hide();this.show()}},toggleVisible:function(){if(this.visible){this.hide()}else{this.show()}}};$(b).bind("focus",FbCalendar.showCalendarEvent).bind("blur",FbCalendar.hideCalendarEvent).bind("keydown",FbCalendar.hideCalendarEvent).bind("resize",FbCalendar.refreshCalendarEvent);this.instances[c.id]=c;$(b).data("calendar",c);if($(b).val()==""){var a=new Date();c.changeDate(a.getMonth()+1,a.getFullYear())}return c}};function proto_getHeight(a){return proto_getDimensions(a)[1]}function proto_getWidth(a){return proto_getDimensions(a)[0]}function proto_getDimensions(c){var g=c.style.display;if(g!="none"&&g!=null){return[c.offsetWidth,c.offsetHeight]}var b=c.style;var f=b.visibility;var d=b.position;var a=b.display;b.visibility="hidden";b.position="absolute";b.display="block";var h=c.clientWidth;var e=c.clientHeight;b.display=a;b.position=d;b.visibility=f;return[h,e]}function findPos(a){var b=curtop=0;if(a.offsetParent){b=a.offsetLeft;curtop=a.offsetTop;while(a=a.offsetParent){b+=a.offsetLeft;curtop+=a.offsetTop}}return[b,curtop]}function util_windowDims(){var b=0;var a=0;if(typeof(window.innerWidth)=="number"){b=window.innerWidth;a=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){b=document.documentElement.clientWidth;a=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){b=document.body.clientWidth;a=document.body.clientHeight}}}return[b,a]}function util_scrollDims(){var b=0,a=0;if(typeof(window.pageYOffset)=="number"){a=window.pageYOffset;b=window.pageXOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){a=document.body.scrollTop;b=document.body.scrollLeft}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){a=document.documentElement.scrollTop;b=document.documentElement.scrollLeft}}}return[b,a]}dhtmlxAjax={get:function(a,c){var b=new dtmlXMLLoaderObject(true);b.async=(arguments.length<3);b.waitCall=c;b.loadXML(a);return b},post:function(a,c,d){var b=new dtmlXMLLoaderObject(true);b.async=(arguments.length<4);b.waitCall=d;b.loadXML(a,true,c);return b},getSync:function(a){return this.get(a,null,true)},postSync:function(a,b){return this.post(a,b,null,true)}};function dtmlXMLLoaderObject(b,d,c,a){this.xmlDoc="";if(typeof(c)!="undefined"){this.async=c}else{this.async=true}this.onloadAction=b||null;this.mainObject=d||null;this.waitCall=null;this.rSeed=a||false;return this}dtmlXMLLoaderObject.prototype.waitLoadFunction=function(b){var a=true;this.check=function(){if((b)&&(b.onloadAction!=null)){if((!b.xmlDoc.readyState)||(b.xmlDoc.readyState==4)){if(!a){return}a=false;if(typeof b.onloadAction=="function"){b.onloadAction(b.mainObject,null,null,null,b)}if(b.waitCall){b.waitCall.call(this,b);b.waitCall=null}}}};return this.check};dtmlXMLLoaderObject.prototype.getXMLTopNode=function(c,a){if(this.xmlDoc.responseXML){var b=this.xmlDoc.responseXML.getElementsByTagName(c);if(b.length==0&&c.indexOf(":")!=-1){var b=this.xmlDoc.responseXML.getElementsByTagName((c.split(":"))[1])}var e=b[0]}else{var e=this.xmlDoc.documentElement}if(e){this._retry=false;return e}if((_isIE)&&(!this._retry)){var d=this.xmlDoc.responseText;var a=this.xmlDoc;this._retry=true;this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=false;this.xmlDoc.loadXML(d);return this.getXMLTopNode(c,a)}dhtmlxError.throwError("LoadXML","Incorrect XML",[(a||this.xmlDoc),this.mainObject]);return document.createElement("DIV")};dtmlXMLLoaderObject.prototype.loadXMLString=function(b){try{var c=new DOMParser();this.xmlDoc=c.parseFromString(b,"text/xml")}catch(a){this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=this.async;this.xmlDoc.loadXML(b)}this.onloadAction(this.mainObject,null,null,null,this);if(this.waitCall){this.waitCall();this.waitCall=null}};dtmlXMLLoaderObject.prototype.loadXML=function(c,b,a,d){if(this.rSeed){c+=((c.indexOf("?")!=-1)?"&":"?")+"a_dhx_rSeed="+(new Date()).valueOf()}this.filePath=c;if((!_isIE)&&(window.XMLHttpRequest)){this.xmlDoc=new XMLHttpRequest()}else{if(document.implementation&&document.implementation.createDocument){this.xmlDoc=document.implementation.createDocument("","",null);this.xmlDoc.onload=new this.waitLoadFunction(this);this.xmlDoc.load(c);return}else{this.xmlDoc=new ActiveXObject("Microsoft.XMLHTTP")}}if(this.async){this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)}this.xmlDoc.open(b?"POST":"GET",c,this.async);if(d){this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")");this.xmlDoc.setRequestHeader("Content-type","text/xml")}else{if(b){this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded")}}this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(null||a);if(!this.async){(new this.waitLoadFunction(this))()}};dtmlXMLLoaderObject.prototype.destructor=function(){this.onloadAction=null;this.mainObject=null;this.xmlDoc=null;return null};dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(d){var c={};for(var b=0;b<d.attributes.length;b++){c[d.attributes[b].name]=d.attributes[b].value}c._tagvalue=d.firstChild?d.firstChild.nodeValue:"";for(var b=0;b<d.childNodes.length;b++){var a=d.childNodes[b].tagName;if(a){if(!c[a]){c[a]=[]}c[a].push(this.xmlNodeToJSON(d.childNodes[b]))}}return c};function callerFunction(a,b){this.handler=function(c){if(!c){c=window.event}a(c,b);return true};return this.handler}function getAbsoluteLeft(b){var c=b.offsetLeft;var a=b.offsetParent;while(a!=null){c+=a.offsetLeft;a=a.offsetParent}return c}function getAbsoluteTop(c){var b=c.offsetTop;var a=c.offsetParent;while(a!=null){b+=a.offsetTop;a=a.offsetParent}return b}function convertStringToBoolean(a){if(typeof(a)=="string"){a=a.toLowerCase()}switch(a){case"1":case"true":case"yes":case"y":case 1:case true:return true;break;default:return false}}function getUrlSymbol(a){if(a.indexOf("?")!=-1){return"&"}else{return"?"}}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop){return window.dhtmlDragAndDrop}this.lastLanding=0;this.dragNode=0;this.dragStartNode=0;this.dragStartObject=0;this.tempDOMU=null;this.tempDOMM=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}dhtmlDragAndDropObject.prototype.removeDraggableItem=function(a){a.onmousedown=null;a.dragStarter=null;a.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(a,b){a.onmousedown=this.preCreateDragCopy;a.dragStarter=b;this.addDragLanding(a,b)};dhtmlDragAndDropObject.prototype.addDragLanding=function(a,b){a.dragLanding=b};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(a){if(a&&(a||event).button==2){return}if(window.dhtmlDragAndDrop.waitDrag){window.dhtmlDragAndDrop.waitDrag=0;document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU;document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM;return false}window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;if((a)&&(a.preventDefault)){a.preventDefault();return false}return false};dhtmlDragAndDropObject.prototype.callDrag=function(c){if(!c){c=window.event}dragger=window.dhtmlDragAndDrop;if((c.button==0)&&(_isIE)){return dragger.stopDrag()}if(!dragger.dragNode&&dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,c);if(!dragger.dragNode){return dragger.stopDrag()}dragger.dragNode.onselectstart=function(){return false};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}if(dragger.dragNode.parentNode!=window.document.body){var a=dragger.gldragNode;if(dragger.gldragNode.old){a=dragger.gldragNode.old}a.parentNode.removeChild(a);var b=dragger.dragNode.pWindow;if(_isIE){var f=document.createElement("Div");f.innerHTML=dragger.dragNode.outerHTML;dragger.dragNode=f.childNodes[0]}else{dragger.dragNode=dragger.dragNode.cloneNode(true)}dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);b.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=c.clientX+15+(dragger.fx?dragger.fx*(-1):0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=c.clientY+3+(dragger.fy?dragger.fy*(-1):0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";if(!c.srcElement){var d=c.target}else{d=c.srcElement}dragger.checkLanding(d,c)};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(e){if(window.name){var c=parent.frames[window.name].frameElement.offsetParent;var d=0;var b=0;while(c){d+=c.offsetLeft;b+=c.offsetTop;c=c.offsetParent}if((parent.dhtmlDragAndDrop)){var a=parent.dhtmlDragAndDrop.calculateFramePosition(1);d+=a.split("_")[0]*1;b+=a.split("_")[1]*1}if(e){return d+"_"+b}else{this.fx=d}this.fy=b}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(b,a){if((b)&&(b.dragLanding)){if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding)}this.lastLanding=b;this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,a.clientX,a.clientY,a);this.lastLanding_scr=(_isIE?a.srcElement:a.target)}else{if((b)&&(b.tagName!="BODY")){this.checkLanding(b.parentNode,a)}else{if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding,a.clientX,a.clientY,a)}this.lastLanding=0;if(this._onNotFound){this._onNotFound()}}}};dhtmlDragAndDropObject.prototype.stopDrag=function(b,c){dragger=window.dhtmlDragAndDrop;if(!c){dragger.stopFrameRoute();var a=dragger.lastLanding;dragger.lastLanding=null;if(a){a.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,a,(_isIE?event.srcElement:b.target))}}dragger.lastLanding=null;if((dragger.dragNode)&&(dragger.dragNode.parentNode==document.body)){dragger.dragNode.parentNode.removeChild(dragger.dragNode)}dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(b){if(b){window.dhtmlDragAndDrop.stopDrag(1,1)}for(var a=0;a<window.frames.length;a++){if((window.frames[a]!=b)&&(window.frames[a].dhtmlDragAndDrop)){window.frames[a].dhtmlDragAndDrop.stopFrameRoute(window)}}if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=b)){parent.dhtmlDragAndDrop.stopFrameRoute(window)}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(b,c){if(b){window.dhtmlDragAndDrop.preCreateDragCopy();window.dhtmlDragAndDrop.dragStartNode=b.dhtmlDragAndDrop.dragStartNode;window.dhtmlDragAndDrop.dragStartObject=b.dhtmlDragAndDrop.dragStartObject;window.dhtmlDragAndDrop.dragNode=b.dhtmlDragAndDrop.dragNode;window.dhtmlDragAndDrop.gldragNode=b.dhtmlDragAndDrop.dragNode;window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag;window.waitDrag=0;if(((!_isIE)&&(c))&&((!_isFF)||(_FFrv<1.8))){window.dhtmlDragAndDrop.calculateFramePosition()}}if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=b)){parent.dhtmlDragAndDrop.initFrameRoute(window)}for(var a=0;a<window.frames.length;a++){if((window.frames[a]!=b)&&(window.frames[a].dhtmlDragAndDrop)){window.frames[a].dhtmlDragAndDrop.initFrameRoute(window,((!b||c)?1:0))}}};var _isFF=false;var _isIE=false;var _isOpera=false;var _isKHTML=false;var _isMacOS=false;if(navigator.userAgent.indexOf("Macintosh")!=-1){_isMacOS=true}if((navigator.userAgent.indexOf("Safari")!=-1)||(navigator.userAgent.indexOf("Konqueror")!=-1)){var _KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5));if(_KHTMLrv>525){_isFF=true;var _FFrv=1.9}else{_isKHTML=true}}else{if(navigator.userAgent.indexOf("Opera")!=-1){_isOpera=true;_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))}else{if(navigator.appName.indexOf("Microsoft")!=-1){_isIE=true;if(navigator.appVersion.indexOf("MSIE 8.0")!=-1&&document.compatMode!="BackCompat"){_isIE=8}}else{_isFF=true;var _FFrv=parseFloat(navigator.userAgent.split("rv:")[1])}}}dtmlXMLLoaderObject.prototype.doXPath=function(c,e,d,j){if((_isKHTML)){return this.doXPathOpera(c,e)}if(_isIE){if(!e){if(!this.xmlDoc.nodeName){e=this.xmlDoc.responseXML}else{e=this.xmlDoc}}if(!e){dhtmlxError.throwError("LoadXML","Incorrect XML",[(e||this.xmlDoc),this.mainObject])}if(d!=null){e.setProperty("SelectionNamespaces","xmlns:xsl='"+d+"'")}if(j=="single"){return e.selectSingleNode(c)}else{return e.selectNodes(c)||new Array(0)}}else{var a=e;if(!e){if(!this.xmlDoc.nodeName){e=this.xmlDoc.responseXML}else{e=this.xmlDoc}}if(!e){dhtmlxError.throwError("LoadXML","Incorrect XML",[(e||this.xmlDoc),this.mainObject])}if(e.nodeName.indexOf("document")!=-1){a=e}else{a=e;e=e.ownerDocument}var g=XPathResult.ANY_TYPE;if(j=="single"){g=XPathResult.FIRST_ORDERED_NODE_TYPE}var f=new Array();var b=e.evaluate(c,a,function(k){return d},g,null);if(g==XPathResult.FIRST_ORDERED_NODE_TYPE){return b.singleNodeValue}var h=b.iterateNext();while(h){f[f.length]=h;h=b.iterateNext()}return f}};function _dhtmlxError(b,a,c){if(!this.catches){this.catches=new Array()}return this}_dhtmlxError.prototype.catchError=function(b,a){this.catches[b]=a};_dhtmlxError.prototype.throwError=function(b,a,c){if(this.catches[b]){return this.catches[b](b,a,c)}if(this.catches.ALL){return this.catches.ALL(b,a,c)}alert("Error type: "+arguments[0]+"\nDescription: "+arguments[1]);return null};window.dhtmlxError=new _dhtmlxError();dtmlXMLLoaderObject.prototype.doXPathOpera=function(c,a){var e=c.replace(/[\/]+/gi,"/").split("/");var d=null;var b=1;if(!e.length){return[]}if(e[0]=="."){d=[a]}else{if(e[0]==""){d=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(e[b].replace(/\[[^\]]*\]/g,""));b++}else{return[]}}for(b;b<e.length;b++){d=this._getAllNamedChilds(d,e[b])}if(e[b-1].indexOf("[")!=-1){d=this._filterXPath(d,e[b-1])}return d};dtmlXMLLoaderObject.prototype._filterXPath=function(e,d){var g=new Array();var d=d.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,"");for(var f=0;f<e.length;f++){if(e[f].getAttribute(d)){g[g.length]=e[f]}}return g};dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(e,d){var h=new Array();if(_isKHTML){d=d.toUpperCase()}for(var g=0;g<e.length;g++){for(var f=0;f<e[g].childNodes.length;f++){if(_isKHTML){if(e[g].childNodes[f].tagName&&e[g].childNodes[f].tagName.toUpperCase()==d){h[h.length]=e[g].childNodes[f]}}else{if(e[g].childNodes[f].tagName==d){h[h.length]=e[g].childNodes[f]}}}}return h};function dhtmlXHeir(e,d){for(var f in d){if(typeof(d[f])=="function"){e[f]=d[f]}}return e}function dhtmlxEvent(b,c,a){if(b.addEventListener){b.addEventListener(c,a,false)}else{if(b.attachEvent){b.attachEvent("on"+c,a)}}}dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(b,c,d){if(!d){d=this.xslDoc}if(d.responseXML){d=d.responseXML}var a=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+b+"']",d,"http://www.w3.org/1999/XSL/Transform","single");if(a!=null){a.firstChild.nodeValue=c}};dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(d,b){if(!d){d=this.xslDoc}if(d.responseXML){d=d.responseXML}if(!b){b=this.xmlDoc}if(b.responseXML){b=b.responseXML}if(!_isIE){if(!this.XSLProcessor){this.XSLProcessor=new XSLTProcessor();this.XSLProcessor.importStylesheet(d)}var a=this.XSLProcessor.transformToDocument(b)}else{var a=new ActiveXObject("Msxml2.DOMDocument.3.0");try{b.transformNodeToObject(d,a)}catch(c){a=b.transformNode(d)}}return a};dtmlXMLLoaderObject.prototype.doXSLTransToString=function(c,b){var a=this.doXSLTransToObject(c,b);if(typeof(a)=="string"){return a}return this.doSerialization(a)};dtmlXMLLoaderObject.prototype.doSerialization=function(b){if(!b){b=this.xmlDoc}if(b.responseXML){b=b.responseXML}if(!_isIE){var a=new XMLSerializer();return a.serializeToString(b)}else{return b.xml}};dhtmlxEventable=function(obj){obj.dhx_SeverCatcherPath="";obj.attachEvent=function(name,catcher,callObj){name="ev_"+name.toLowerCase();if(!this[name]){this[name]=new this.eventCatcher(callObj||this)}return(name+":"+this[name].addEvent(catcher))};obj.callEvent=function(name,arg0){name="ev_"+name.toLowerCase();if(this[name]){return this[name].apply(this,arg0)}return true};obj.checkEvent=function(name){return(!!this["ev_"+name.toLowerCase()])};obj.eventCatcher=function(obj){var dhx_catch=[];var z=function(){var res=true;for(var i=0;i<dhx_catch.length;i++){if(dhx_catch[i]!=null){var zr=dhx_catch[i].apply(obj,arguments);res=res&&zr}}return res};z.addEvent=function(ev){if(typeof(ev)!="function"){ev=eval(ev)}if(ev){return dhx_catch.push(ev)-1}return false};z.removeEvent=function(id){dhx_catch[id]=null};return z};obj.detachEvent=function(id){if(id!=false){var list=id.split(":");this[list[0]].removeEvent(list[1])}}};function dhtmlXComboFromSelect(h,k){if(typeof(h)=="string"){h=document.getElementById(h)}k=k||h.getAttribute("width")||(window.getComputedStyle?window.getComputedStyle(h,null)["width"]:(h.currentStyle?h.currentStyle.width:0));if((!k)||(k=="auto")){k=h.offsetWidth||100}var d=document.createElement("SPAN");if(h.style.direction=="rtl"){d.style.direction="rtl"}h.parentNode.insertBefore(d,h);h.style.display="none";var e=h.getAttribute("opt_type");var j=new dhtmlXCombo(d,h.name,k,e,h.tabIndex);var g=[];var a=0;for(var c=0;c<h.options.length;c++){if(h.options[c].selected){a=c}var f=h.options[c].innerHTML;var b=h.options[c].getAttribute("value");if((typeof(b)=="undefined")||(b===null)){b=f}g[c]={value:b,text:f,img_src:h.options[c].getAttribute("img_src")}}j.addOption(g);h.parentNode.removeChild(h);j.selectOption(a,null,true);if(h.onchange){j.attachEvent("onChange",h.onchange)}return j}var dhtmlXCombo_optionTypes=[];function dhtmlXCombo(d,b,c,e,a){if(typeof(d)=="string"){d=document.getElementById(d)}dhtmlxEventable(this);this.optionType=(e!=window.undefined&&dhtmlXCombo_optionTypes[e])?e:"default";this._optionObject=dhtmlXCombo_optionTypes[this.optionType];this._disabled=false;if(d.style.direction=="rtl"){this.rtl=true}else{this.rtl=false}if(!window.dhx_glbSelectAr){window.dhx_glbSelectAr=[];window.dhx_openedSelect=null;window.dhx_SelectId=1;dhtmlxEvent(document.body,"click",this.closeAll);dhtmlxEvent(document.body,"keydown",function(f){try{if((f||event).keyCode==9){window.dhx_glbSelectAr[0].closeAll()}}catch(f){}return true})}if(d.tagName=="SELECT"){return dhtmlXComboFromSelect(d)}else{this._createSelf(d,b,c,a)}dhx_glbSelectAr.push(this)}dhtmlXCombo.prototype.setSize=function(a){this.DOMlist.style.width=a+"px";if(this.DOMlistF){this.DOMlistF.style.width=a+"px"}this.DOMelem.style.width=a+"px";this.DOMelem_input.style.width=Math.max(0,(a-19))+"px"};dhtmlXCombo.prototype.enableFilteringMode=function(d,c,b,a){this._filter=convertStringToBoolean(d);if(c){this._xml=c;this._autoxml=convertStringToBoolean(a)}if(convertStringToBoolean(b)){this._xmlCache=[]}};dhtmlXCombo.prototype.setFilteringParam=function(a,b){if(!this._prs){this._prs=[]}this._prs.push([a,b])};dhtmlXCombo.prototype.disable=function(b){var a=convertStringToBoolean(b);if(this._disabled==a){return}this.DOMelem_input.disabled=a;this._disabled=a};dhtmlXCombo.prototype.readonly=function(b,c){this.DOMelem_input.readOnly=b?true:false;if(c===false||b===false){this.DOMelem.onkeyup=function(d){}}else{var a=this;a.searchString="";a.clearKeypressTimeout=null;this.DOMelem.onkeyup=function(f){if(a.clearKeypressTimeout){clearTimeout(a.clearKeypressTimeout);a.clearKeypressTimeout=null}a.clearKeypressTimeout=setTimeout(function(){a.searchString=""},1000);f=f||window.event;if(f.keyCode!=9){f.cancelBubble=true}var g=f.keyCode;if(g>=96&&g<=105){g-=48}if((g>=48&&g<=57)||(g>=65&&g<=90)){var d=String.fromCharCode(g);a.searchString+=d;for(var e=0;e<a.optionsArr.length;e++){var h=a.optionsArr[e].text;if(h.toString().toUpperCase().indexOf(a.searchString)==0){a.selectOption(e,false,false);break}}f.cancelBubble=true}}}};dhtmlXCombo.prototype.getOption=function(b){for(var a=0;a<this.optionsArr.length;a++){if(this.optionsArr[a].value==b){return this.optionsArr[a]}}return null};dhtmlXCombo.prototype.getOptionByLabel=function(b){for(var a=0;a<this.optionsArr.length;a++){if(this.optionsArr[a].text==b||this.optionsArr[a]._ctext==b){return this.optionsArr[a]}}return null};dhtmlXCombo.prototype.getOptionByIndex=function(a){return this.optionsArr[a]};dhtmlXCombo.prototype.clearAll=function(a){if(a){this.setComboText("")}this.optionsArr=new Array();this.redrawOptions();if(a){this._confirmSelection()}};dhtmlXCombo.prototype.deleteOption=function(b){var a=this.getIndexByValue(b);if(a<0){return}if(this.optionsArr[a]==this._selOption){this._selOption=null}this.optionsArr.splice(a,1);this.redrawOptions()};dhtmlXCombo.prototype.render=function(a){this._skiprender=(!convertStringToBoolean(a));this.redrawOptions()};dhtmlXCombo.prototype.updateOption=function(d,a,c,e){var b=this.getOption(d);if(typeof(a)!="object"){a={text:c,value:a,css:e}}b.setValue(a);this.redrawOptions()};dhtmlXCombo.prototype.addOption=function(b){if(!arguments[0].length||typeof(arguments[0])!="object"){args=[arguments]}else{args=b}for(var c=0;c<args.length;c++){var a=args[c];if(a.length){a.value=a[0]||"";a.text=a[1]||"";a.css=a[2]||"";a.unique_key=a[3]||""}this._addOption(a)}};dhtmlXCombo.prototype._addOption=function(a){dOpt=new this._optionObject();this.optionsArr.push(dOpt);dOpt.setValue.apply(dOpt,[a]);this.callEvent("onAddOption",[dOpt])};dhtmlXCombo.prototype.getIndexByValue=function(b){for(var a=0;a<this.optionsArr.length;a++){if(this.optionsArr[a].value==b){return a}}return -1};dhtmlXCombo.prototype.getSelectedValue=function(){return(this._selOption?this._selOption.value:null)};dhtmlXCombo.prototype.getUniqueKey=function(){return(this._selOption?this._selOption.unique_key:null)};dhtmlXCombo.prototype.setUniqueKey=function(a){if(this._selOption){this._selOption.unique_key=a}};dhtmlXCombo.prototype.getComboText=function(){return this.DOMelem_input.value};dhtmlXCombo.prototype.setComboText=function(a){this.DOMelem_input.value=a};dhtmlXCombo.prototype.setComboValue=function(b){this.setComboText(b);for(var a=0;a<this.optionsArr.length;a++){if(this.optionsArr[a].data()[0]==b){return this.selectOption(a,null,true)}}this.DOMelem_hidden_input.value=b};dhtmlXCombo.prototype.setComboValueByUniqueKey=function(b){this.setComboText(b);for(var a=0;a<this.optionsArr.length;a++){if(this.optionsArr[a].unique_key==b){return this.selectOption(a,null,true)}}this.DOMelem_hidden_input.value=b};dhtmlXCombo.prototype.getActualValue=function(){return this.DOMelem_hidden_input.value};dhtmlXCombo.prototype.getSelectedText=function(){return(this._selOption?this._selOption.text:"")};dhtmlXCombo.prototype.getSelectedIndex=function(){for(var a=0;a<this.optionsArr.length;a++){if(this.optionsArr[a]==this._selOption){return a}}return -1};dhtmlXCombo.prototype.setName=function(a){this.DOMelem_hidden_input.name=a;this.DOMelem_hidden_input2="__new_"+a;this.name=a};dhtmlXCombo.prototype.show=function(a){if(convertStringToBoolean(a)){this.DOMelem.style.display="";this.render(false)}else{this.DOMelem.style.display="none"}};dhtmlXCombo.prototype.destructor=function(){var a=this._inID;this.DOMParent.removeChild(this.DOMelem);this.DOMlist.parentNode.removeChild(this.DOMlist);var c=dhx_glbSelectAr;this.DOMParent=this.DOMlist=this.DOMelem=0;this.DOMlist.combo=this.DOMelem.combo=0;for(var b=0;b<c.length;b++){if(c[b]._inID==a){c[b]=null;c.splice(b,1);return}}};dhtmlXCombo.prototype._createSelf=function(d,b,g,f){if(g.toString().indexOf("%")!=-1){var a=this;var e=parseInt(g)/100;window.setInterval(function(){if(!d.parentNode){return}var j=d.parentNode.offsetWidth*e-2;if(j<0){return}if(j==a._lastTs){return}a.setSize(a._lastTs=j)},500);var g=parseInt(d.offsetWidth)}var g=parseInt(g||100);this.listWidth=g;this.ListPosition="Bottom";this.DOMParent=d;this._inID=null;this.name=b;this._selOption=null;this.optionsArr=[];var c=new this._optionObject();c.DrawHeader(this,b,g,f);var h=document.getElementById("dhx_combo_list");if(!h){this.createDOMlist()}else{this.DOMlist=h}this.DOMelem.combo=this;this.DOMelem_input.onkeydown=this._onKey;this.DOMelem_input.onkeypress=this._onKeyF;this.DOMelem_input.onblur=this._onBlur;this.DOMelem.onclick=this._toggleSelect;if(_isIE){this.DOMlistF=document.createElement("IFRAME");this.DOMlistF.frameBorder="0";this.DOMlistF.style.border="0";this.DOMlistF.className="dhx_combo_list";this.DOMlistF.style.width=g-(_isIE?0:0)+"px";this.DOMlistF.style.display="none";this.DOMlistF.src="javascript:false;";document.body.insertBefore(this.DOMlistF,document.body.firstChild)}};dhtmlXCombo.prototype.createDOMlist=function(b,a){this.DOMlist=document.createElement("DIV");this.DOMlist.className="dhx_combo_list";this.DOMlist.id="dhx_combo_list";if(this.rtl){this.DOMlist.className="dhx_combo_list_rtl"}if(_isOpera||_isKHTML){this.DOMlist.style.overflow="auto"}this.DOMlist.style.display="none";document.body.insertBefore(this.DOMlist,document.body.firstChild)};dhtmlXCombo.prototype._listOver=function(d){d=d||event;d.cancelBubble=true;var c=(_isIE?event.srcElement:d.target);var b=this.combo;if(c.parentNode==b.DOMlist){if(b._selOption){b._selOption.deselect()}if(b._tempSel){b._tempSel.deselect()}var a=0;for(a;a<b.DOMlist.childNodes.length;a++){if(b.DOMlist.childNodes[a]==c){break}}var f=b.optionsArr[a];b._tempSel=f;b._tempSel.select();if((b._autoxml)&&((a+1)==b._lastLength)){b._fetchOptions(a+1,b._lasttext||"")}}};dhtmlXCombo.prototype._positList=function(){var a=this.getPosition(this.DOMelem);if(this.ListPosition=="Bottom"){this.DOMlist.style.top=a[1]+this.DOMelem.offsetHeight+"px";this.DOMlist.style.left=a[0]+"px"}else{if(this.ListPosition=="Top"){this.DOMlist.style.top=a[1]-this.DOMlist.offsetHeight+"px";this.DOMlist.style.left=a[0]+"px"}else{this.DOMlist.style.top=a[1]+"px";this.DOMlist.style.left=a[0]+this.DOMelem.offsetWidth+"px"}}this.DOMlist.style.width=this.listWidth+"px"};dhtmlXCombo.prototype.getPosition=function(e,b){if(!b){var b=document.body}var a=e;var d=0;var c=0;while((a)&&(a!=b)){d+=a.offsetLeft-a.scrollLeft;c+=a.offsetTop-a.scrollTop;a=a.offsetParent}if(b==document.body){if(_isIE&&$.browser.version.match(/^(6|7)/)){if(document.documentElement.scrollTop){c+=document.documentElement.scrollTop}if(document.documentElement.scrollLeft){d+=document.documentElement.scrollLeft}}else{if(!_isFF){d+=document.body.offsetLeft;c+=document.body.offsetTop}}}return new Array(d,c)};dhtmlXCombo.prototype._correctSelection=function(){if(this.getComboText()!=""){for(var a=0;a<this.optionsArr.length;a++){if(!this.optionsArr[a].isHidden()){return this.selectOption(a,true,false)}}}this.unSelectOption()};dhtmlXCombo.prototype.selectNext=function(a){var b=this.getSelectedIndex()+a;while(this.optionsArr[b]){if(!this.optionsArr[b].isHidden()){return this.selectOption(b,false,false)}b+=a}};dhtmlXCombo.prototype._onKeyF=function(c){var b=this.parentNode.combo;var a=c||event;a.cancelBubble=true;if(a.keyCode=="13"||a.keyCode=="9"){b._confirmSelection();b.closeAll()}else{if(a.keyCode=="27"){b._resetSelection();b.closeAll()}else{b._activeMode=true}}if(a.keyCode=="13"||a.keyCode=="27"){b.callEvent("onKeyPressed",[a.keyCode]);return false}return true};dhtmlXCombo.prototype._onKey=function(c){var b=this.parentNode.combo;(c||event).cancelBubble=true;var a=(c||event).keyCode;if(a>15&&a<19){return true}if(a==27){return}if((b.DOMlist.style.display!="block")&&(a!="13")&&(a!="9")&&((!b._filter)||(b._filterAny))){b.DOMelem.onclick(c||event)}if((a!="13")&&(a!="9")){window.setTimeout(function(){b._onKeyB(a)},1);if(a=="40"||a=="38"){return false}}else{if(a==9){b.closeAll();(c||event).cancelBubble=false}}};dhtmlXCombo.prototype._onKeyB=function(b){if(b=="40"){var c=this.selectNext(1)}else{if(b=="38"){this.selectNext(-1)}else{this.callEvent("onKeyPressed",[b]);if(this._filter){return this.filterSelf((b==8)||(b==46))}for(var a=0;a<this.optionsArr.length;a++){if(this.optionsArr[a].data()[1]==this.DOMelem_input.value){this.selectOption(a,false,false);return false}}this.unSelectOption()}}return true};dhtmlXCombo.prototype._onBlur=function(){var a=this.parentNode._self;window.setTimeout(function(){if(a.DOMlist._skipBlur){return !(a.DOMlist._skipBlur=false)}a._confirmSelection();a.callEvent("onBlur",[])},100)};dhtmlXCombo.prototype.redrawOptions=function(){if(this._skiprender){return}for(var a=this.DOMlist.childNodes.length-1;a>=0;a--){this.DOMlist.removeChild(this.DOMlist.childNodes[a])}for(var a=0;a<this.optionsArr.length;a++){this.DOMlist.appendChild(this.optionsArr[a].render())}};dhtmlXCombo.prototype.loadXML=function(b,d){this._load=true;this.callEvent("onXLS",[]);if((this._xmlCache)&&(this._xmlCache[b])){this._fillFromXML(this,null,null,null,this._xmlCache[b]);if(d){d()}}else{var a=(new dtmlXMLLoaderObject(this._fillFromXML,this,true,true));if(d){a.waitCall=d}if(this._prs){for(var c=0;c<this._prs.length;c++){b+=[getUrlSymbol(b),escape(this._prs[c][0]),"=",escape(this._prs[c][1])].join("")}}a._cPath=b;a.loadXML(b)}};dhtmlXCombo.prototype.loadXMLString=function(a){var b=(new dtmlXMLLoaderObject(this._fillFromXML,this,true,true));b.loadXMLString(a)};dhtmlXCombo.prototype._fillFromXML=function(h,q,n,m,k){if(h._xmlCache){h._xmlCache[k._cPath]=k}var o=k.getXMLTopNode("complete");if(o.tagName!="complete"){return}var p=k.doXPath("//complete");var s=k.doXPath("//option");h.render(false);if((!p[0])||(!p[0].getAttribute("add"))){h.clearAll();h._lastLength=s.length;if(h._xml){if((!s)||(!s.length)){h.closeAll()}else{if(h._activeMode){h._positList();h.DOMlist.style.display="block";if(_isIE){h._IEFix(true)}}}}}else{h._lastLength+=s.length}for(var g=0;g<s.length;g++){var l=new Object();l.text=s[g].firstChild?s[g].firstChild.nodeValue:"";for(var f=0;f<s[g].attributes.length;f++){var r=s[g].attributes[f];if(r){l[r.nodeName]=r.nodeValue}}h._addOption(l)}h.render(true);if((h._load)&&(h._load!==true)){h.loadXML(h._load)}else{h._load=false;if((!h._lkmode)&&(!h._filter)){h._correctSelection()}}var e=k.doXPath("//option[@selected]");if(e.length){h.selectOption(h.getIndexByValue(e[0].getAttribute("value")),false,true)}h.callEvent("onXLE",[])};dhtmlXCombo.prototype.unSelectOption=function(){if(this._selOption){this._selOption.deselect()}if(this._tempSel){this._tempSel.deselect()}this._tempSel=this._selOption=null};dhtmlXCombo.prototype._confirmSelection=function(b,a){if(arguments.length==0){var c=this.getOptionByLabel(this.DOMelem_input.value);b=c?c.value:this.DOMelem_input.value;a=(c==null);if(b==this.getActualValue()){return}}this.DOMelem_hidden_input.value=b;this.DOMelem_hidden_input2.value=(a?"true":"false");this.callEvent("onChange",[]);this._activeMode=false};dhtmlXCombo.prototype._resetSelection=function(b,a){var c=this.getOption(this.DOMelem_hidden_input.value);this.setComboValue(c?c.data()[0]:this.DOMelem_hidden_input.value);this.setComboText(c?c.data()[1]:this.DOMelem_hidden_input.value)};dhtmlXCombo.prototype.selectOption=function(d,b,a){if(arguments.length<3){a=true}this.unSelectOption();var f=this.optionsArr[d];if(!f||f.disabled){return}this._selOption=f;this._selOption.select();this._selOption.render();if(d==0){}else{var g=this._selOption.content.offsetTop+this._selOption.content.offsetHeight-this.DOMlist.scrollTop-this.DOMlist.offsetHeight;if(g>0){this.DOMlist.scrollTop+=g}g=this.DOMlist.scrollTop-this._selOption.content.offsetTop;if(g>0){this.DOMlist.scrollTop-=g}}var c=this._selOption.data();if(a){this.setComboText(c[1]);this._confirmSelection(c[0],false)}if((this._autoxml)&&((d+1)==this._lastLength)){this._fetchOptions(d+1,this._lasttext||"")}if(b){var e=this.getComboText();if(e!=c[1]){this.setComboText(c[1]);dhtmlXRange(this.DOMelem_input,e.length+1,c[1].length)}}else{this.setComboText(c[1])}this._selOption.RedrawHeader(this);this.callEvent("onSelectionChange",[])};dhtmlXCombo.prototype._selectOption=function(d){(d||event).cancelBubble=true;var c=(_isIE?event.srcElement:d.target);var b=this.combo;while(!c._self){c=c.parentNode;if(!c){return}}var a=0;for(a;a<b.DOMlist.childNodes.length;a++){if(b.DOMlist.childNodes[a]==c){break}}b.selectOption(a,false,true);b.closeAll();b.callEvent("onBlur",[]);b._activeMode=false};dhtmlXCombo.prototype.openSelect=function(){if(this._disabled){return}this.DOMlist.combo=this;this.DOMlist.onclick=this._selectOption;this.DOMlist.onmousedown=function(){this._skipBlur=true};this.DOMlist.onkeydown=function(b){this.combo.DOMelem_input.focus();(b||event).cancelBubble=true;this.combo.DOMelem_input.onkeydown(b)};this.DOMlist.onmouseover=this._listOver;this.closeAll();this._positList();this.render(true);this.DOMlist.style.display="block";this.callEvent("onOpen",[]);if(this._tempSel){this._tempSel.deselect()}if(this._selOption){this._selOption.select()}if(this._selOption){var a=this._selOption.content.offsetTop+this._selOption.content.offsetHeight-this.DOMlist.scrollTop-this.DOMlist.offsetHeight;if(a>0){this.DOMlist.scrollTop+=a}a=this.DOMlist.scrollTop-this._selOption.content.offsetTop;if(a>0){this.DOMlist.scrollTop-=a}}if(_isIE){this._IEFix(true)}this.DOMelem_input.focus()};dhtmlXCombo.prototype._toggleSelect=function(d,b){var c=this.combo;for(var a=0;a<c.optionsArr.length;a++){c.optionsArr[a].hide(false)}if(c.DOMlist.style.display=="block"){c.closeAll();if(c.DOMlist.combo!=this.combo){c.openSelect()}}else{c.openSelect()}(d||event).cancelBubble=true};dhtmlXCombo.prototype._fetchOptions=function(b,c){if(c==""){this.closeAll();return this.clearAll()}var a=this._xml+((this._xml.indexOf("?")!=-1)?"&":"?")+"pos="+b+"&mask="+encodeURIComponent(c);this._lasttext=c;if(this._load){this._load=a}else{this.loadXML(a)}};dhtmlXCombo.prototype.filterSelf=function(g){var f=this.getComboText();if(this._xml){this._lkmode=g;this._fetchOptions(0,f)}try{var b=new RegExp("^"+f,"i")}catch(c){var b=new RegExp("^"+f.replace(/([\[\]\{\}\(\)\+\*\\])/g,"\\$1"))}this.filterAny=false;for(var a=0;a<this.optionsArr.length;a++){var d=b.test(this.optionsArr[a].text);this.filterAny|=d;this.optionsArr[a].hide(!d)}if(!this.filterAny){this.closeAll();this._activeMode=true}else{if(this.DOMlist.style.display!="block"){this.openSelect()}if(_isIE){this._IEFix(true)}}if(!g){this._correctSelection()}else{this.unSelectOption()}};dhtmlXCombo.prototype._IEFix=function(a){this.DOMlistF.style.display=(a?"block":"none");this.DOMlistF.style.top=this.DOMlist.style.top;this.DOMlistF.style.left=this.DOMlist.style.left;this.DOMlistF.style.height=this.DOMlist.offsetHeight};dhtmlXCombo.prototype.closeAll=function(){if(window.dhx_glbSelectAr){for(var a=0;a<dhx_glbSelectAr.length;a++){if(dhx_glbSelectAr[a].DOMlist.style.display=="block"){dhx_glbSelectAr[a].DOMlist.style.display="none"}if(_isIE){dhx_glbSelectAr[a]._IEFix(false)}dhx_glbSelectAr[a]._activeMode=false}}};function dhtmlXRange(a,d,h){var g=typeof(a)=="object"?a:document.getElementById(a);try{g.focus()}catch(f){}var c=g.value.length;d--;if(d<0||d>h||d>c){d=0}if(h>c){h=c}if(d==h){return}if(g.setSelectionRange){g.setSelectionRange(d,h)}else{if(g.createTextRange){var b=g.createTextRange();b.moveStart("character",d);b.moveEnd("character",h-c);b.select()}}}dhtmlXCombo_defaultOption=function(){this.init()};dhtmlXCombo_defaultOption.prototype.init=function(){this.value=null;this.text="";this.selected=false;this.css="";this.className="";this.unique_key="";this.disabled=false;this.tooltipText=""};dhtmlXCombo_defaultOption.prototype.select=function(){if(this.content){$(this.content).addClass("dhx_selected_option")}};dhtmlXCombo_defaultOption.prototype.hide=function(a){this.render().style.display=a?"none":""};dhtmlXCombo_defaultOption.prototype.isHidden=function(){return(this.render().style.display=="none")};dhtmlXCombo_defaultOption.prototype.deselect=function(){if(this.content){this.render()}$(this.content).removeClass("dhx_selected_option")};dhtmlXCombo_defaultOption.prototype.setValue=function(a){this.value=a.value||"";this.text=a.text||"";this.css=a.css||"";this.className=a.className||"";this.unique_key=a.unique_key||"";this.content=null;this.disabled=a.disabled||false;this.tooltipText=a.tooltipText||""};dhtmlXCombo_defaultOption.prototype.render=function(){if(!this.content){this.content=document.createElement("DIV");this.content._self=this;this.content.style.cssText="width:100%; overflow:hidden;"+this.css;if(_isOpera||_isKHTML){this.content.style.padding="2px 0px 2px 0px"}this.content.className=this.disabled?"combobox-disabled "+this.className:this.className;this.content.innerHTML=this.text;this._ctext=_isIE?this.content.innerText:this.content.textContent;if(this.tooltipText){this.content.title=this.tooltipText;this.content.innerHTML='<span class="tool-tip">'+this.text+"</span>";$(this.content).tooltip({extraClass:"combobox-tooltip"})}}return this.content};dhtmlXCombo_defaultOption.prototype.data=function(){return[this.value,this._ctext?this._ctext:this.text]};dhtmlXCombo_defaultOption.prototype.DrawHeader=function(a,b,d,c){var e=document.createElement("DIV");e.style.width=d+"px";e.className="dhx_combo_box";e._self=a;a.DOMelem=e;this._DrawHeaderInput(a,b,d,c);this._DrawHeaderButton(a,b,d);a.DOMParent.appendChild(a.DOMelem)};dhtmlXCombo_defaultOption.prototype._DrawHeaderInput=function(a,b,d,c){if(a.rtl&&_isIE){var e=document.createElement("textarea");e.style.overflow="hidden";e.style.whiteSpace="nowrap"}else{var e=document.createElement("input");e.setAttribute("autocomplete","off");e.type="text"}e.className="dhx_combo_input";if(a.rtl){e.style.left="18px";e.style.direction="rtl";e.style.unicodeBidi="bidi-override"}if(c){e.tabIndex=c}e.style.width=(d-19)+"px";a.DOMelem.appendChild(e);a.DOMelem_input=e;e=document.createElement("input");e.type="hidden";e.name=b;a.DOMelem.appendChild(e);a.DOMelem_hidden_input=e;e=document.createElement("input");e.type="hidden";e.name="__new_"+b;e.value="true";a.DOMelem.appendChild(e);a.DOMelem_hidden_input2=e};dhtmlXCombo_defaultOption.prototype._DrawHeaderButton=function(a,b,c){var d=document.createElement("img");d.className=(a.rtl)?"dhx_combo_img_rtl":"dhx_combo_img";d.src=(window.dhx_globalImgPath?dhx_globalImgPath:"")+"combo_select.gif";a.DOMelem.appendChild(d);a.DOMelem_button=d};dhtmlXCombo_defaultOption.prototype.RedrawHeader=function(a){};dhtmlXCombo_optionTypes["default"]=dhtmlXCombo_defaultOption;